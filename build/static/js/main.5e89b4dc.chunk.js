(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{20:function(e,n,t){},40:function(e,n,t){"use strict";t.r(n);var r=t(2),c=t.n(r),a=t(15),i=t.n(a),o=(t(20),t(6)),u=t(3),d=t(4),s=t.n(d),l="/api/persons",h={getPersons:function(){return s.a.get(l).then((function(e){return e.data}))},addPerson:function(e){return s.a.post(l,e).then((function(e){return e.data}))},deletePerson:function(e){return s.a.delete("".concat(l,"/").concat(e))},updatePerson:function(e,n){return s.a.put("".concat(l,"/").concat(e),n).then((function(e){return e.data}))}},j=t(0),b=function(e){var n=e.filter,t=e.handleChange;return Object(j.jsxs)("div",{children:["filter shown with ",Object(j.jsx)("input",{value:n,onChange:t})]})},f=function(e){var n=e.name,t=e.number,r=e.handleSubmit,c=e.handleNameChange,a=e.handleNumberChange;return Object(j.jsxs)("form",{onSubmit:r,children:[Object(j.jsxs)("div",{children:["name: ",Object(j.jsx)("input",{required:!0,value:n,onChange:c})]}),Object(j.jsxs)("div",{children:["number: ",Object(j.jsx)("input",{required:!0,value:t,onChange:a})]}),Object(j.jsx)("div",{children:Object(j.jsx)("button",{type:"submit",children:"add"})})]})},m=function(e){var n=e.label,t=e.id,r=e.handleClick;return Object(j.jsx)("button",{onClick:function(){return r(t)},children:n})},p=function(e){var n=e.name,t=e.number,r=e.id,c=e.handleClick;return Object(j.jsxs)("li",{children:[n," ",t," ",Object(j.jsx)(m,{label:"delete",id:r,handleClick:c})]})},O=function(e){var n=e.persons,t=e.filter,c=e.handleClick,a=Object(r.useMemo)((function(){return new RegExp("".concat(t),"i")}),[t]);return Object(j.jsx)("ul",{children:n.filter((function(e){return a.test(e.name)})).map((function(e){return Object(j.jsx)(p,{name:e.name,number:e.number,id:e.id,handleClick:c},e.id)}))})},v=function(e){var n=e.notification;return Object(j.jsx)("span",{className:"notification ".concat("error"===n.type?"error ":"success"===n.type?"success ":"").concat(n.active?"show":"hide"),children:n.content})};var x=function(){var e=Object(r.useState)([]),n=Object(u.a)(e,2),t=n[0],c=n[1],a=Object(r.useState)(""),i=Object(u.a)(a,2),d=i[0],s=i[1],l=Object(r.useState)(""),m=Object(u.a)(l,2),p=m[0],x=m[1],g=Object(r.useState)(""),C=Object(u.a)(g,2),w=C[0],k=C[1],S=Object(r.useState)(null),P=Object(u.a)(S,2),y=P[0],N=P[1];Object(r.useEffect)((function(){h.getPersons().then((function(e){c(e)}))}),[]);var D=function(e,n,t){var r={content:function(e,n){return{"person added":"Added ".concat(n),"person deleted":"Deleted ".concat(n),"person updated":"Updated ".concat(n),"delete error":"".concat(n," has already been deleted from the server"),"update error":n,"unexpected error":"Something went wrong"}[e]}(e,t),type:n,active:!0};N(r),setTimeout((function(){N(Object(o.a)(Object(o.a)({},r),{},{active:!1}))}),5e3)};return Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"header",children:[Object(j.jsx)("h2",{children:"Phonebook"}),y&&Object(j.jsx)(v,{notification:y})]}),Object(j.jsx)(b,{filter:w,handleChange:function(e){k(e.target.value)}}),Object(j.jsx)("h2",{children:"add a new"}),Object(j.jsx)(f,{name:d,number:p,handleSubmit:function(e){e.preventDefault();var n={name:d,number:p};if(t.some((function(e){return e.name===n.name}))){if(window.confirm("".concat(d," is already added to phonebook, replace the old number with a new one?"))){var r=t.find((function(e){return e.name===n.name})).id;h.updatePerson(r,n).then((function(e){c(t.map((function(n){return n.id===e.id?e:n}))),D("person updated","success",e.name)})).catch((function(){return D("unexpected error","error",null)}))}}else h.addPerson(n).then((function(e){c(t.concat(e)),D("person added","success",e.name)})).catch((function(e){D("update error","error",e.response.data.error)}));s(""),x("")},handleNameChange:function(e){s(e.target.value)},handleNumberChange:function(e){x(e.target.value)}}),Object(j.jsx)("h2",{children:"Numbers"}),Object(j.jsx)(O,{persons:t,filter:w,handleClick:function(e){var n=t.find((function(n){return n.id===e}));window.confirm("Delete ".concat(n.name,"?"))&&(h.deletePerson(e).then((function(e){204===e.status&&D("person deleted","success",n.name)})).catch((function(e){D("delete error","error",n.name)})),c(t.filter((function(n){return n.id!==e}))))}})]})};i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(x,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.5e89b4dc.chunk.js.map